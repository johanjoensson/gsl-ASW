add_executable(gsl-asw main.cpp)
add_executable(atomic atomic.cpp)

check_ipo_supported(RESULT ipo_result)
if(ipo_result)
	set_property(TARGET gsl-asw PROPERTY INTERPROCEDURAL_OPTIMIZATION TRUE)
	set_property(TARGET atomic PROPERTY INTERPROCEDURAL_OPTIMIZATION TRUE)
endif()

target_link_libraries(gsl-asw PRIVATE gsl-asw-lib)
target_compile_features(gsl-asw PRIVATE cxx_std_11)

if(CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
	target_compile_options(gsl-asw PRIVATE $<$<CONFIG:DEBUG>:${WFLAGS} -Og -pg>)
	target_link_options(gsl-asw PRIVATE $<$<CONFIG:DEBUG>:-Og -pg>)
	target_compile_options(gsl-asw PRIVATE $<$<CONFIG:RELEASE>:${WFLAGS} -Ofast>)
	target_link_options(gsl-asw PRIVATE $<$<CONFIG:RELEASE>:-Ofast>)

	target_compile_options(atomic PRIVATE $<$<CONFIG:DEBUG>:${WFLAGS} -Og -pg>)
	target_link_options(atomic PRIVATE $<$<CONFIG:DEBUG>:-Og -pg>)
	target_compile_options(atomic PRIVATE $<$<CONFIG:RELEASE>:${WFLAGS} -Ofast>)
	target_link_options(atomic PRIVATE $<$<CONFIG:RELEASE>:-Ofast>)
else()
	target_compile_options(gsl-asw PRIVATE $<$<CONFIG:DEBUG>:${WFLAGS} -Og -pg -DDEBUG>)
	target_link_options(gsl-asw PRIVATE $<$<CONFIG:DEBUG>:-Og -pg>)
	target_compile_options(gsl-asw PRIVATE $<$<CONFIG:RELEASE>:${WFLAGS} -O2>)
	target_link_options(gsl-asw PRIVATE $<$<CONFIG:RELEASE>:-O2>)

	target_compile_options(atomic PRIVATE $<$<CONFIG:DEBUG>:${WFLAGS} -pg -Og>)
	target_link_options(atomic PRIVATE $<$<CONFIG:DEBUG>:-Og -pg>)
	target_compile_options(atomic PRIVATE $<$<CONFIG:RELEASE>:${WFLAGS} -Ofast>)
	target_link_options(atomic PRIVATE $<$<CONFIG:RELEASE>:-Ofast>)
endif()

target_include_directories(atomic PUBLIC ${PROJECT_SOURCE_DIR}/include/gsl-asw)
target_include_directories(atomic PUBLIC ${GSLpp_ROOT}/include/)
target_link_libraries(atomic PRIVATE gsl-asw-lib)
